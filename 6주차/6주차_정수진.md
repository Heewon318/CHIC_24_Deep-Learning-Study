# 08. 이미지 분류

454-504

- **객체나 장면**과 같은 요소를 인식하고 분류하는 알고리즘
- 지도학습 중 하나
- 이미지와 클래스를 할당해 데이터 세트 구성

→ 컴퓨터 비전 분야, 사용자가 입력한 이미지를 사전에 정의한 클래스 중 가장 유사한 클래스로 판별

### 분류 방법

1. 단일 클래스 분류: 대표 클래스로만 참/거짓 판별(개)
2. 다중 클래스 분류: 종류를 분류(개, 고양이)
3. 다중 레이블 분류: 여러 클래스를 예측(개, 소파, 블라인드) - 여러 레이블을 동시에 처리, 1과2보다 많은 데이터와 복잡한 모델 구조 요구

### 이미지 분류에 사용되는 기술

1. 서포트 벡터 머신(SVM)
2. K-최근접 이웃 알고리즘(KNN)
3. 의사결정 나무(Decision Tree)
4. 인공 신경망(ANN)
5. **합성곱 신경망(CNN)**

⇒ 여러 방법 중에서 이번 장에서는 합성곱 신경망으로 구성된 모델에 대해서 살펴볼 예정임

특징: 특징 맵의 차원수가 늘어날 수록 모델의 표현력 증가, 크기 감소해 연산량을 줄임

## AlexNet

2012 ILSVRC 대회 우승: 인식 오류율을 26%→16%로 낮춤

이후 깊은 구조를 가진 모델(Deep Architecture)들이 나오기 시작함

![921870D4-3D57-4795-A924-84777A0C890C](https://github.com/user-attachments/assets/ec2c40ac-190a-40b7-a613-d08386708bc2)

이미지 특징 추출 ⇒ 합성곱과 최대값 풀링 계층 활용

순전파 과정 : 특징 맵의 차원수 증가, 크기 감소

⇒ 합성곱 네트워크는 특징 맵의 크기를 줄이면서 차원수를 증가시키는 구조로 이루어짐

입력층(I)

합성곱 계층(C1, C3, C5, C6, C7)

서브샘플링 계층(S2, S4, S8) - 최댓값 풀링

완전 연결 계층(FC9, FC10, FC11)

출력층(O) 

활성화 함수 : ReLU(비선형 활성화 함수 - 기울기 소실 문제 발생 X ⇒ 더 깊은 계층을 쌓을 수 있음)

## LeNet-5

입력층(I)

합성곱 계층(C1, C3)

서브샘플링 계층(S2, S4) - 평균값 풀링

완전 연결 계층(FC5)

출력층(O) 

활성화 함수 : 출력층(시그모이드-기울기 소실 문제 유발), 나머지 계층(하이퍼볼릭 탄젠트)

|  | 입력 이미지 크기 | 활성화 함수 | 풀링 방식 | 드롭 아웃 |
| --- | --- | --- | --- | --- |
| LeNet-5 | 32 x 32 | Rescaled Logistic Sigmoid Function | 평균값 | X |
| AlexNet | 227 x 227 | ReLU | 최댓값 | O |

### 입력 이미지의 크기

**LeNet-5**

32x32 픽셀 - 원래 흑백 손글씨 숫자 데이터를 위한 MNIST 데이터셋에 맞춰져 있음

**AlexNet**

227x227 픽셀 - 훨씬 더 큰 데이터셋(예: ImageNet)에서 다루는 이미지를 처리할 수 있도록 설계됨

- 입력 이미지 크기 관련
    
    **227x227**
    
    AlexNet의 원래 논문에서 사용된 입력 이미지 크기는 227x227입니다. 이 크기는 이미지 전처리 과정에서 최종적으로 AlexNet 모델에 입력되는 이미지 크기입니다.
    
    **224x224**
    
    PyTorch와 같은 딥러닝 프레임워크에서 제공하는 사전 학습된 AlexNet 모델은 보통 224x224 크기의 이미지를 사용합니다. 이는 다양한 딥러닝 프레임워크에서 표준으로 사용되는 크기이며, ResNet 등 다른 모델과 일관성을 유지하기 위해 사용됩니다.
    
    **256x256의 역할**
    
    **전처리 단계**:
    
    **Resize(256x256)**: 원본 이미지의 크기가 다를 수 있기 때문에, 첫 번째로 이미지를 256x256 크기로 리사이즈합니다. 이 크기로 이미지를 맞추는 것은 이후 단계에서 이미지의 특정 부분을 크롭하는 작업을 용이하게 합니다.
    
    **무작위 크롭(Random Cropping)**:
    
    이미지가 256x256 크기로 조정된 후, 그 이미지에서 무작위로 224x224 크기의 패치를 잘라내어 모델에 입력합니다. 이 과정은 데이터 증강의 일환으로, 모델이 다양한 위치와 크기의 패치를 보게 만들어 일반화 능력을 향상시킵니다.
    

### 풀링 방식

**LeNet-5**

서브샘플링(Subsampling) 또는 평균 풀링(Average Pooling)을 사용 - 컨볼루션된 이미지의 크기를 줄이는 데 사용됨

**AlexNet**

최대 풀링(Max Pooling)을 사용 - 컨볼루션된 이미지에서 가장 큰 값을 선택하여 공간 정보를 더 잘 보존하면서 크기를 줄이는 데 도움이 됨

### **드롭아웃(Dropout)**

**LeNet-5**

드롭아웃은 당시에는 존재하지 않던 기법임

**AlexNet**

드롭아웃 레이어를 사용해, 특정 노드를 임의로 비활성화하여 모델이 특정 특징에 과적합되지 않도록 도움 - 일반화 성능을 향상시키는 데에 기여함
